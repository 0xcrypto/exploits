<?php
$min_epoch = 1262304000;
$max_epoch = time();

function check_crc32($match, $time) {
        return sprintf('%x', crc32('@craft/web/assets/cp/dist|'. $time . '|'));
}

for ($time = $max_epoch; $time > $min_epoch; $time--) {
        $crc = check_crc32($argv[1], $time);
        echo "\r$crc:$time";
        if($crc == $argv[1]) {
                echo "\n$crc matched $time\n";

                $releases = json_decode(file_get_contents("releases.json"));
                $current_release = current($releases);
                foreach($releases as $release => $releasetime) {
                        if($time > $releasetime) {
                                echo "[+] CraftCMS v$release, Released on ".date('r', $releasetime)."\n";
                                break;
                        }
                        $current_release = $release;
                }
                break;
        }
}
